<div class="profile-container">
  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-avatar">
      <div class="avatar-circle">
        {{ getUserInitials() }}
      </div>
    </div>
    <div class="profile-info">
      <h1 class="profile-name">{{ getUserFullName() }}</h1>
      <p class="profile-role">{{ getRoleDisplayName() }}</p>
      <p class="profile-email">{{ currentUser?.email }}</p>
    </div>
  </div>

  <!-- Success/Error Messages -->
  <div *ngIf="profileUpdateSuccess" class="alert alert-success">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
    </svg>
    Profile updated successfully!
  </div>

  <div *ngIf="errorMessage" class="alert alert-error">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
      <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
      <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
    </svg>
    {{ errorMessage }}
  </div>

  <div *ngIf="successMessage" class="alert alert-success">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
    </svg>
    {{ successMessage }}
  </div>

  <div class="profile-layout">
    <!-- Profile Navigation -->
    <div class="profile-nav">
      <div class="nav-header">
        <h2>Profile Sections</h2>
      </div>
      <nav class="nav-menu">
        <button *ngFor="let section of profileSections" (click)="setActiveSection(section.id)"
          [class.active]="activeSection === section.id" class="nav-item">
          <div class="nav-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Dynamic icon based on section.icon -->
              <ng-container [ngSwitch]="section.icon">
                <g *ngSwitchCase="'building'">
                  <path d="M3 21h18" stroke="currentColor" stroke-width="2" />
                  <path d="M5 21V7l8-4v18" stroke="currentColor" stroke-width="2" />
                  <path d="M19 21V11l-6-4" stroke="currentColor" stroke-width="2" />
                </g>
                <g *ngSwitchCase="'briefcase'">
                  <rect x="2" y="7" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2" />
                  <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" stroke="currentColor" stroke-width="2" />
                </g>
                <g *ngSwitchCase="'users'">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" />
                  <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87" stroke="currentColor" stroke-width="2" />
                  <path d="M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" />
                </g>
                <g *ngSwitchCase="'settings'">
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                  <path
                    d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
                    stroke="currentColor" stroke-width="2" />
                </g>
              </ng-container>
            </svg>
          </div>
          <div class="nav-content">
            <span class="nav-title">{{ section.title }}</span>
            <span class="nav-description">{{ section.description }}</span>
          </div>
        </button>
      </nav>
    </div>

    <!-- Profile Content -->
    <div class="profile-content">
      <!-- Company Information Section -->
      <div *ngIf="activeSection === 'personal'" class="profile-section">
        <div class="section-header">
          <h2 class="section-title">Company Information</h2>
          <button *ngIf="!isEditingProfile" (click)="toggleEditProfile()" class="btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor"
                stroke-width="2" />
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor"
                stroke-width="2" />
            </svg>
            Edit Company Information
          </button>
        </div>

        <!-- Company Information Form -->
        <form *ngIf="isEditingProfile" [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()"
          class="profile-edit-form">
          <!-- Contact Information Card -->
          <div class="form-card">
            <div class="form-card-header">
              <div class="form-card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" />
                  <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                </svg>
              </div>
              <div class="form-card-title">
                <h3>Contact Information</h3>
                <p>Company contact details and representative information</p>
              </div>
            </div>
            <div class="form-card-content">
              <div class="form-row">
                <div class="form-group">
                  <label for="firstName" class="form-label">First Name *</label>
                  <input type="text" id="firstName" formControlName="firstName" class="form-input"
                    [class.error]="getFieldError('firstName')">
                  <div *ngIf="getFieldError('firstName')" class="field-error">
                    {{ getFieldError('firstName') }}
                  </div>
                </div>
                <div class="form-group">
                  <label for="lastName" class="form-label">Last Name *</label>
                  <input type="text" id="lastName" formControlName="lastName" class="form-input"
                    [class.error]="getFieldError('lastName')">
                  <div *ngIf="getFieldError('lastName')" class="field-error">
                    {{ getFieldError('lastName') }}
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="email" class="form-label">Email Address *</label>
                  <input type="email" id="email" formControlName="email" class="form-input"
                    [class.error]="getFieldError('email')">
                  <div *ngIf="getFieldError('email')" class="field-error">
                    {{ getFieldError('email') }}
                  </div>
                </div>
                <div class="form-group">
                  <label for="phone" class="form-label">Phone Number</label>
                  <input type="tel" id="phone" formControlName="phone" class="form-input"
                    placeholder="+1 (555) 123-4567">
                </div>
              </div>
            </div>
          </div>

          <!-- Company Details Card -->
          <div class="form-card">
            <div class="form-card-header">
              <div class="form-card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 21h18" stroke="currentColor" stroke-width="2" />
                  <path d="M5 21V7l8-4v18" stroke="currentColor" stroke-width="2" />
                  <path d="M19 21V11l-6-4" stroke="currentColor" stroke-width="2" />
                </svg>
              </div>
              <div class="form-card-title">
                <h3>Company Details</h3>
                <p>Business information and company profile</p>
              </div>
            </div>
            <div class="form-card-content">
              <div class="form-group">
                <label for="companyName" class="form-label">Company Name *</label>
                <input type="text" id="companyName" formControlName="companyName" class="form-input"
                  [class.error]="getFieldError('companyName')">
                <div *ngIf="getFieldError('companyName')" class="field-error">
                  {{ getFieldError('companyName') }}
                </div>
              </div>

              <div class="form-group">
                <label for="companyDescription" class="form-label">Company Description</label>
                <textarea id="companyDescription" formControlName="companyDescription" class="form-textarea" rows="4"
                  placeholder="Brief description of your company..."></textarea>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="companyWebsite" class="form-label">Company Website</label>
                  <input type="url" id="companyWebsite" formControlName="companyWebsite" class="form-input"
                    placeholder="https://company.com">
                </div>
                <div class="form-group">
                  <label for="companySize" class="form-label">Company Size</label>
                  <select id="companySize" formControlName="companySize" class="form-select">
                    <option value="">Select size</option>
                    <option value="1-10">1-10 employees</option>
                    <option value="11-50">11-50 employees</option>
                    <option value="51-200">51-200 employees</option>
                    <option value="201-500">201-500 employees</option>
                    <option value="501-1000">501-1000 employees</option>
                    <option value="1000+">1000+ employees</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="industry" class="form-label">Industry</label>
                <select id="industry" formControlName="industry" class="form-select">
                  <option value="">Select industry</option>
                  <option value="technology">Technology</option>
                  <option value="healthcare">Healthcare</option>
                  <option value="finance">Finance</option>
                  <option value="education">Education</option>
                  <option value="retail">Retail</option>
                  <option value="manufacturing">Manufacturing</option>
                  <option value="consulting">Consulting</option>
                  <option value="media">Media & Entertainment</option>
                  <option value="nonprofit">Non-profit</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions-card">
            <button type="button" (click)="toggleEditProfile()" class="btn-secondary">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" />
                <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" />
              </svg>
              Cancel
            </button>
            <button type="submit" class="btn-primary" [disabled]="isLoading">
              <span *ngIf="isLoading" class="loading-spinner"></span>
              <svg *ngIf="!isLoading" width="16" height="16" viewBox="0 0 24 24" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" />
                <polyline points="22,4 12,14.01 9,11.01" stroke="currentColor" stroke-width="2" />
              </svg>
              {{ isLoading ? 'Saving...' : 'Save Changes' }}
            </button>
          </div>
        </form>

        <!-- Company Information Display -->
        <div *ngIf="!isEditingProfile" class="personal-info-list">
          <div class="personal-info-item">
            <div class="personal-info-header">
              <div class="personal-info-details">
                <h3 class="personal-info-title">Contact Information</h3>
                <p class="personal-info-description">Company contact details and representative information</p>
                <p class="personal-info-meta">Member since {{ formatDate(currentUser?.createdAt) }}</p>
              </div>
            </div>
            <div class="personal-info-content">
              <div class="personal-info-grid">
                <div class="personal-info-value">
                  <span class="personal-info-label">Full Name</span>
                  <span class="personal-info-text">
                    {{ (userProfile?.personalInfo?.firstName || currentUser?.firstName) }}
                    {{ (userProfile?.personalInfo?.lastName || currentUser?.lastName) }}
                  </span>
                </div>
                <div class="personal-info-value">
                  <span class="personal-info-label">Email Address</span>
                  <span class="personal-info-text">{{ (userProfile?.personalInfo?.email || currentUser?.email) }}</span>
                </div>
                <div class="personal-info-value" *ngIf="userProfile?.personalInfo?.phone">
                  <span class="personal-info-label">Phone Number</span>
                  <span class="personal-info-text">{{ userProfile?.personalInfo?.phone }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="personal-info-item">
            <div class="personal-info-header">
              <div class="personal-info-details">
                <h3 class="personal-info-title">Company Details</h3>
                <p class="personal-info-description">Business information and company profile</p>
                <p class="personal-info-meta">Company overview and business details</p>
              </div>
            </div>
            <div class="personal-info-content">
              <div class="personal-info-grid">
                <div class="personal-info-value">
                  <span class="personal-info-label">Company Name</span>
                  <span class="personal-info-text">{{ currentUser?.companyName || 'Not specified' }}</span>
                </div>
                <div class="personal-info-value" *ngIf="currentUser?.industry">
                  <span class="personal-info-label">Industry</span>
                  <span class="personal-info-text">{{ currentUser?.industry | titlecase }}</span>
                </div>
                <div class="personal-info-value" *ngIf="currentUser?.companySize">
                  <span class="personal-info-label">Company Size</span>
                  <span class="personal-info-text">{{ currentUser?.companySize }}</span>
                </div>
                <div class="personal-info-value" *ngIf="currentUser?.companyWebsite">
                  <span class="personal-info-label">Website</span>
                  <a [href]="currentUser?.companyWebsite" target="_blank" class="personal-info-link">
                    View Website
                  </a>
                </div>
                <div class="personal-info-value" *ngIf="currentUser?.companyDescription">
                  <span class="personal-info-label">Description</span>
                  <span class="personal-info-text">{{ currentUser?.companyDescription }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Job Postings Section -->
      <div *ngIf="activeSection === 'jobs'" class="profile-section">
        <div class="section-header">
          <h2 class="section-title">Job Postings</h2>
          <button (click)="navigateToCreateJob()" class="btn-primary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2" />
              <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2" />
            </svg>
            Post New Job
          </button>
        </div>

        <div class="jobs-list">
          <div *ngFor="let job of companyJobs" class="job-item">
            <div class="job-item-header">
              <div class="job-item-info">
                <h4 class="job-item-title">{{ job.title }}</h4>
                <p class="job-item-subtitle">{{ job.location }} â€¢ {{ job.type }}</p>
                <div class="job-item-meta">
                  <span class="status-badge" [class]="getJobStatusClass(job.status)">{{ job.status | titlecase }}</span>
                  <span class="date-text">Posted {{ getTimeAgo(job.createdAt) }}</span>
                  <span class="applications-count">{{ job.applicationsCount || 0 }} applications</span>
                </div>
              </div>
            </div>
            <div class="job-item-actions">
              <button (click)="editJob(job.id)" class="btn-secondary-small">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor"
                    stroke-width="2" />
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor"
                    stroke-width="2" />
                </svg>
              </button>
              <button (click)="deleteJob(job.id)" class="btn-danger-small">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    stroke="currentColor" stroke-width="2" />
                </svg>
              </button>
            </div>
          </div>

          <div *ngIf="companyJobs.length === 0" class="empty-state">
            <div class="empty-state-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="2" y="7" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2" />
                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" stroke="currentColor" stroke-width="2" />
              </svg>
            </div>
            <h3 class="empty-state-title">No Job Postings</h3>
            <p class="empty-state-description">You haven't posted any jobs yet. Create your first job posting to start
              attracting candidates.</p>
            <button (click)="navigateToCreateJob()" class="btn-primary">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2" />
                <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2" />
              </svg>
              Post Your First Job
            </button>
          </div>
        </div>
      </div>

      <!-- Applications Section -->
      <div *ngIf="activeSection === 'applications'" class="profile-section">
        <div class="section-header">
          <h2 class="section-title">Applications</h2>
        </div>

        <!-- Application Filters -->
        <div class="application-filters">
          <div class="filter-group">
            <input type="text" [(ngModel)]="applicationSearchQuery" (input)="filterApplications()"
              placeholder="Search applications..." class="search-input">
          </div>
          <div class="filter-group">
            <select [(ngModel)]="selectedApplicationStatus" (change)="filterApplications()" class="filter-select">
              <option value="">All Status</option>
              <option value="pending">Pending</option>
              <option value="reviewed">Reviewed</option>
              <option value="shortlisted">Shortlisted</option>
              <option value="rejected">Rejected</option>
              <option value="hired">Hired</option>
            </select>
          </div>
        </div>

        <div class="applications-list">
          <div *ngFor="let application of filteredApplications" class="application-item">
            <div class="application-item-header">
              <div class="applicant-avatar">
                <div class="avatar-circle-small">
                  {{ application.applicantName?.charAt(0) || 'A' }}
                </div>
              </div>
              <div class="application-item-info">
                <h4 class="application-item-title">{{ application.applicantName }}</h4>
                <p class="application-item-subtitle">Applied for {{ application.jobTitle }}</p>
                <div class="application-item-meta">
                  <span class="status-badge" [class]="getApplicationStatusClass(application.status)">{{
                    application.status | titlecase }}</span>
                  <span class="date-text">Applied {{ getTimeAgo(application.appliedAt) }}</span>
                </div>
              </div>
            </div>
            <div class="application-item-actions">
              <select (change)="onApplicationStatusChange(application, $event)" [value]="application.status"
                class="status-select">
                <option value="pending">Pending</option>
                <option value="reviewed">Reviewed</option>
                <option value="shortlisted">Shortlisted</option>
                <option value="rejected">Rejected</option>
                <option value="hired">Hired</option>
              </select>
              <button (click)="viewApplication(application.id)" class="btn-secondary-small">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" />
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                </svg>
              </button>
            </div>
          </div>

          <div *ngIf="filteredApplications.length === 0" class="empty-state">
            <div class="empty-state-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" />
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" stroke="currentColor" stroke-width="2" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" />
              </svg>
            </div>
            <h3 class="empty-state-title">No Applications</h3>
            <p class="empty-state-description">No applications have been received yet. Post more jobs to attract
              candidates.</p>
          </div>
        </div>
      </div>

      <!-- Preferences Section -->
      <div *ngIf="activeSection === 'preferences'" class="profile-section">
        <div class="section-header">
          <h2 class="section-title">Preferences</h2>
        </div>
        <div class="preferences-content">
          <div class="settings-card">
            <div class="settings-card-header">
              <h3>Company Preferences</h3>
              <p>Customize your company experience and hiring preferences</p>
            </div>
            <div class="settings-card-content">
              <p>Company preference options will be implemented here.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>