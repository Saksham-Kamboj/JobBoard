<div class="settings-container">
  <!-- Settings Header -->
  <div class="settings-header">
    <h1 class="settings-title">Settings</h1>
    <p class="settings-subtitle">Manage your account preferences and application settings</p>
  </div>

  <div class="settings-layout">
    <!-- Settings Sidebar -->
    <div class="settings-sidebar">
      <nav class="settings-nav">
        <button *ngFor="let category of settingsCategories" (click)="setActiveCategory(category.id)"
          class="settings-nav-item" [class.active]="activeCategory === category.id">
          <div class="nav-icon">
            <!-- Palette Icon -->
            <svg *ngIf="category.icon === 'palette'" width="20" height="20" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <circle cx="13.5" cy="6.5" r=".5" fill="currentColor" />
              <circle cx="17.5" cy="10.5" r=".5" fill="currentColor" />
              <circle cx="8.5" cy="7.5" r=".5" fill="currentColor" />
              <circle cx="6.5" cy="12.5" r=".5" fill="currentColor" />
              <path
                d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 7.012 17.461 2 12 2z"
                stroke="currentColor" stroke-width="2" />
            </svg>
            <!-- Bell Icon -->
            <svg *ngIf="category.icon === 'bell'" width="20" height="20" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" />
              <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" />
            </svg>
            <!-- Shield Icon -->
            <svg *ngIf="category.icon === 'shield'" width="20" height="20" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke="currentColor" stroke-width="2" />
            </svg>
            <!-- User Icon -->
            <svg *ngIf="category.icon === 'user'" width="20" height="20" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" />
              <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" />
            </svg>
          </div>
          <div class="nav-content">
            <span class="nav-title">{{ category.title }}</span>
            <span class="nav-description">{{ category.description }}</span>
          </div>
        </button>
      </nav>
    </div>

    <!-- Settings Content -->
    <div class="settings-content">
      <!-- Appearance Settings -->
      <div *ngIf="activeCategory === 'appearance'" class="settings-section">
        <div class="section-header">
          <h2 class="section-title">Appearance</h2>
          <p class="section-description">Customize how the application looks and feels</p>
        </div>

        <div class="settings-group">
          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Theme</h3>
              <p class="setting-description">Choose between light and dark mode</p>
            </div>
            <div class="setting-control">
              <div class="theme-toggle-container">
                <button (click)="toggleTheme()" class="theme-toggle-btn" [class.dark]="isDarkMode">
                  <div class="toggle-track">
                    <div class="toggle-thumb">
                      <svg *ngIf="!isDarkMode" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2" />
                        <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2" />
                        <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2" />
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2" />
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2" />
                        <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2" />
                        <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2" />
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2" />
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2" />
                      </svg>
                      <svg *ngIf="isDarkMode" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor"
                          stroke-width="2" />
                      </svg>
                    </div>
                  </div>
                </button>
                <span class="theme-label">{{ isDarkMode ? 'Dark' : 'Light' }} Mode</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Notifications Settings -->
      <div *ngIf="activeCategory === 'notifications'" class="settings-section">
        <div class="section-header">
          <h2 class="section-title">Notifications</h2>
          <p class="section-description">Control how and when you receive notifications</p>
        </div>

        <div class="settings-group">
          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Email Notifications</h3>
              <p class="setting-description">Receive notifications via email</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="notificationSettings.emailNotifications"
                  (change)="onNotificationChange($event, 'emailNotifications')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Job Alerts</h3>
              <p class="setting-description">Get notified about new job opportunities</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="notificationSettings.jobAlerts"
                  (change)="onNotificationChange($event, 'jobAlerts')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Application Updates</h3>
              <p class="setting-description">Receive updates about your job applications</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="notificationSettings.applicationUpdates"
                  (change)="onNotificationChange($event, 'applicationUpdates')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Marketing Emails</h3>
              <p class="setting-description">Receive promotional content and updates</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="notificationSettings.marketingEmails"
                  (change)="onNotificationChange($event, 'marketingEmails')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Privacy Settings -->
      <div *ngIf="activeCategory === 'privacy'" class="settings-section">
        <div class="section-header">
          <h2 class="section-title">Privacy & Security</h2>
          <p class="section-description">Manage your privacy and security preferences</p>
        </div>

        <div class="settings-group">
          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Profile Visibility</h3>
              <p class="setting-description">Control who can see your profile</p>
            </div>
            <div class="setting-control">
              <select class="setting-select" [value]="privacySettings.profileVisibility"
                (change)="onPrivacySelectChange($event, 'profileVisibility')">
                <option value="public">Public</option>
                <option value="private">Private</option>
                <option value="employers-only">Employers Only</option>
              </select>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Show Email Address</h3>
              <p class="setting-description">Display your email on your public profile</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="privacySettings.showEmail"
                  (change)="onPrivacyChange($event, 'showEmail')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Allow Search Engine Indexing</h3>
              <p class="setting-description">Let search engines index your profile</p>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" [checked]="privacySettings.allowSearchEngines"
                  (change)="onPrivacyChange($event, 'allowSearchEngines')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Account Settings -->
      <div *ngIf="activeCategory === 'account'" class="settings-section">
        <div class="section-header">
          <h2 class="section-title">Account</h2>
          <p class="section-description">Manage your account information and security</p>
        </div>

        <!-- Success/Error Messages -->
        <div *ngIf="passwordUpdateSuccess" class="alert alert-success">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
          </svg>
          Password changed successfully!
        </div>

        <div *ngIf="errorMessage" class="alert alert-error">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
            <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
            <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
          </svg>
          {{ errorMessage }}
        </div>

        <div class="settings-group">
          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Change Password</h3>
              <p class="setting-description">Update your account password</p>
            </div>
            <div class="setting-control">
              <button *ngIf="!isChangingPassword" (click)="toggleChangePassword()" class="btn-secondary">
                Change Password
              </button>
            </div>
          </div>

          <!-- Password Change Form -->
          <form *ngIf="isChangingPassword" [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()"
            class="password-form">
            <div class="form-group">
              <label for="currentPassword" class="form-label">Current Password *</label>
              <input type="password" id="currentPassword" formControlName="currentPassword" class="form-input"
                [class.error]="getFieldError('currentPassword')">
              <div *ngIf="getFieldError('currentPassword')" class="field-error">
                {{ getFieldError('currentPassword') }}
              </div>
            </div>

            <div class="form-group">
              <label for="newPassword" class="form-label">New Password *</label>
              <input type="password" id="newPassword" formControlName="newPassword" class="form-input"
                [class.error]="getFieldError('newPassword')">
              <div *ngIf="getFieldError('newPassword')" class="field-error">
                {{ getFieldError('newPassword') }}
              </div>
            </div>

            <div class="form-group">
              <label for="confirmPassword" class="form-label">Confirm New Password *</label>
              <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-input"
                [class.error]="getFieldError('confirmPassword')">
              <div *ngIf="getFieldError('confirmPassword')" class="field-error">
                {{ getFieldError('confirmPassword') }}
              </div>
            </div>

            <div class="form-actions">
              <button type="button" (click)="toggleChangePassword()" class="btn-secondary">
                Cancel
              </button>
              <button type="submit" class="btn-primary" [disabled]="isLoading || passwordForm.invalid">
                <span *ngIf="isLoading" class="loading-spinner"></span>
                {{ isLoading ? 'Changing...' : 'Change Password' }}
              </button>
            </div>
          </form>

          <div class="setting-item">
            <div class="setting-info">
              <h3 class="setting-title">Export Data</h3>
              <p class="setting-description">Download a copy of your data</p>
            </div>
            <div class="setting-control">
              <button (click)="exportData()" class="btn-secondary">
                Export Data
              </button>
            </div>
          </div>

          <div class="setting-item danger">
            <div class="setting-info">
              <h3 class="setting-title">Delete Account</h3>
              <p class="setting-description">Permanently delete your account and all data</p>
            </div>
            <div class="setting-control">
              <button (click)="deleteAccount()" class="btn-danger">
                Delete Account
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>